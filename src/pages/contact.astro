---
import Layout from "@layouts/Layout.astro";
import Nav from "@components/Nav.astro";
import Hero from "@components/Hero.astro";
import Footer from "@components/Footer.astro";
import FAQcard from "@components/subcomponents/FAQcard.astro";
import FAQsection from "@components/subcomponents/FAQsection.astro";
import FancyBg from "@components/subcomponents/FancyBg.astro";
---

<Layout>
    <FancyBg />
    <Nav />
    <main
        class="flex flex-col items-center justify-center min-h-screen gap-16 mx-auto main-content xl:p-0"
    >
        <h1 class="pt-20 header-1">Skontaktuj Się z nami</h1>
        <div class="w-full mx-auto lg:w-128">
            <form id="contactForm" class="space-y-4">
                <div>
                    <label
                        for="name"
                        class="block pl-2 font-medium text-left text-gray-300"
                        >Twoje Imię</label
                    >
                    <input
                        class="w-full p-3 text-sm font-light border-gray-200 rounded-lg bg-neutral-800"
                        placeholder="Jan Kowalski"
                        type="text"
                        id="name"
                        name="name"
                        aria-label="Twoje Imię"
                        data-error="Imię nie może mieć więcej niż 30 znaków."
                        maxlength="30"
                        required
                    />
                </div>

                <div>
                    <label
                        for="email"
                        class="block pl-2 font-medium text-left text-gray-100"
                        >Email</label
                    >
                    <input
                        class="w-full p-3 text-sm font-light border-gray-200 rounded-lg bg-neutral-800"
                        placeholder="Twój Adres Email"
                        type="email"
                        id="email"
                        name="email"
                        aria-label="jan.kowalski@gmail.com"
                        data-error="Email nie może mieć więcej niż 30 znaków."
                        maxlength="30"
                        required
                    />
                </div>

                <div>
                    <label
                        for="message"
                        class="block pl-2 font-medium text-left text-gray-300"
                        >Wiadomość</label
                    >
                    <textarea
                        class="w-full p-3 text-sm font-light border-gray-200 rounded-lg bg-neutral-800"
                        placeholder="Chciałbym zamówić wycenę strony internetowej."
                        rows="8"
                        id="message"
                        name="message"
                        required
                        maxlength="500"
                        data-error="Wiadomość nie może mieć więcej niż 500 znaków."
                        aria-label="Wiadomość"></textarea>
                </div>
                <!-- TODO dodaj stylowanie -->
                <div id="responseInfo"></div>
                <div class="mt-4">
                    <button
                        id="contactButton"
                        type="submit"
                        class="rounded-lg flex font-medium bg-blue-600 text-center text-white py-3 px-16 transition-smooth hover:(bg-transparent border border-blue-600 shadow-xl shadow-blue-600/20)"
                    >
                        Wyślij
                    </button>
                </div>
            </form>
        </div>

        <FAQsection />
    </main>
    <Footer />

    <script type="text/typescript">
        document.addEventListener("DOMContentLoaded", () => {
            const contactForm = document.getElementById(
                "contactForm"
            ) as HTMLFormElement;
            const responseInfo = document.getElementById(
                "responseInfo"
            ) as HTMLElement;
            const contactButton = document.getElementById(
                "contactButton"
            ) as HTMLButtonElement;

            const displayError = (element: HTMLElement, message: string) => {
                responseInfo.textContent = message;
                responseInfo.classList.add("text-red-500");
                element.classList.add("border-red-500");
            };

            const clearError = (element: HTMLElement) => {
                responseInfo.textContent = "";
                responseInfo.classList.remove("text-red-500");
                element.classList.remove("border-red-500");
            };

            const validateInput = (
                inputElement: HTMLInputElement | HTMLTextAreaElement
            ) => {
                const maxLength = parseInt(
                    inputElement.getAttribute("maxlength") || "0",
                    10
                );
                const errorMessage =
                    inputElement.getAttribute("data-error") || "Błąd";
                const valueLength = inputElement.value.length;

                if (valueLength > maxLength) {
                    displayError(inputElement, errorMessage);
                    return false;
                } else {
                    clearError(inputElement);
                    return true;
                }
            };

            contactForm.addEventListener("submit", (event) => {
                event.preventDefault();

                const nameInput = document.getElementById(
                    "name"
                ) as HTMLInputElement;
                const emailInput = document.getElementById(
                    "email"
                ) as HTMLInputElement;
                const messageInput = document.getElementById(
                    "message"
                ) as HTMLTextAreaElement;

                const isNameValid = validateInput(nameInput);
                const isEmailValid = validateInput(emailInput);
                const isMessageValid = validateInput(messageInput);

                if (isNameValid && isEmailValid && isMessageValid) {
                    // Tutaj możesz wysłać formularz na serwer, jeśli wszystko jest poprawne.
                }
            });
        });
    </script>
</Layout>
